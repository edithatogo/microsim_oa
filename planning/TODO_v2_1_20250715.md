# AUS-OA Model v2 To-Do List

**File Version:** 1
**Date:** 2025-07-15

This document breaks down the V2 Roadmap into a checklist of concrete tasks.

---

## Phase 1: Architectural Relaunch & Foundational Capabilities

### Pillar 1.1: Software Engineering Best Practices - MOSTLY COMPLETED
- [x] **Project Structure:**
    - [x] Initialize a new R package structure using `usethis::create_package()`.
    - [x] Move existing R functions into the `R/` directory.
    - [x] Move existing tests into the `tests/testthat/` directory.
    - [x] Document all functions using `roxygen2` style comments.
- [x] **Dependency Management:**
    - [x] Initialize `renv` in the project using `renv::init()`.
    - [x] Snapshot the project dependencies to create a lockfile.
- [x] **Continuous Integration (CI):**
    - [x] Create a GitHub Actions workflow file (`.github/workflows/R-CMD-check.yaml`).
    - [x] Configure the workflow to run `R CMD check` on every push to `main` and `develop` branches.
- [x] **Containerization:**
    - [x] Create a `Dockerfile` that starts from a base R image.
    - [x] Add steps to install system dependencies.
    - [x] Add steps to install the correct R package versions using the `renv.lock` file.
- [ ] **Project Management:**
    - [ ] Set up a GitHub Projects (Kanban) board for the repository.
    - [ ] Convert all tasks in this TODO list into issues and add them to the board.

### Pillar 1.2: Decoupled & Enhanced Configuration - MOSTLY COMPLETED
- [x] **Externalize Parameters:**
    - [x] Create a `config/` directory.
    - [x] Develop a hierarchical structure for YAML configuration files (e.g., `default.yaml`, `costs.yaml`, `interventions.yaml`).
    - [x] Write a function to load and validate all YAML files into a single configuration object.
    - [x] Refactor all functions to take the configuration object as an argument, removing all hardcoded parameters.
- [x] **Policy Lever System:**
    - [x] Design the YAML structure to easily define new interventions (e.g., a new drug with its efficacy, cost, and side effects).
    - [x] Refactor the simulation engine to apply these interventions based on the configuration object.

### Pillar 1.3: Performance Optimization - MOSTLY COMPLETED
- [x] **Profiling:**
    - [x] Use the `profvis` package to profile the main simulation function and identify the top 3-5 performance bottlenecks.
- [x] **Data Manipulation:**
    - [x] Refactor the main data manipulation steps within the simulation loop from `dplyr` to `data.table`.
    - [x] Benchmark the performance before and after the `data.table` refactoring.
- [x] **Data I/O:**
    - [x] Replace all `read.csv`/`write.csv` and `read_excel` calls with `arrow::read_parquet()` and `arrow::write_parquet()`.
    - [x] Convert existing input data files to Parquet format.

### Pillar 1.4: Foundational Module Expansion - PARTIALLY COMPLETED
- [x] **Costing Module:**
    - [x] Create a `costs.yaml` file to store all cost data, with sources and dates.
    - [x] Write a new `calculate_costs()` function that takes the simulation output and the cost configuration and returns a detailed cost breakdown.
    - [x] Add a module to calculate productivity costs based on absenteeism and presenteeism.
- [x] **Pharmacy Module:**
    - [x] Design a flexible `interventions.yaml` section for defining drugs.
    - [x] Create a new `apply_pharmacological_tx()` function that models drug efficacy, side effects, and adherence based on the configuration.
    - [x] Implement logic for dynamic treatment switching.
- [x] **Surgery/Revision Module:**
    - [x] Enhance the `TKA_update_fcn` to model different reasons for revision.
    - [x] Add the ability to use implant-specific survival curves from an external data file as an input.

---

## Phase 2: Expanding the Scope of Analysis (Future Tasks) - PARTIALLY STARTED
- [x] **Clinical Realism:**
    - [x] Integrate PROs (pain/function scores) into the `am_` data structure.
    - [x] Refactor progression functions to be dependent on PROs.
    - [ ] Add modules for PJI and DVT complications.
    - [x] Add a module for non-pharmacological interventions.
- [ ] **Economic & Social Perspective:**
    - [ ] Add a module to calculate the economic and QALY impact on carers.
    - [ ] Model transitions to residential aged care.
    - [ ] Add RA-codes and SEIFA indexes to the synthetic population.
    - [ ] Implement equity analysis outputs.
- [ ] **Advanced Analytics:**
    - [ ] Build a wrapper function to perform a full Probabilistic Sensitivity Analysis (PSA).
    - [ ] Train a proof-of-concept GBM model for OA progression.
    - [ ] Write an XAI analysis report for the GBM model.
    - [ ] Perform a formal external validation of a key model output (e.g., TKR rate) against registry data.

---

## Phase 3: User Experience & Dissemination (Future Tasks)
- [ ] **Scenario & Results Management:**
    - [ ] Develop a basic Shiny app with inputs for key scenario parameters.
    - [ ] Create a `generate_standard_report()` function using R Markdown.
- [ ] **Stakeholder Outputs:**
    - [ ] Design and create the "Executive Dashboard" one-page summary.
    - [ ] Create an R Markdown template for HTA-compliant reports.
    - [ ] Draft plain-language summaries of key findings.
- [ ] **Documentation & Publication:**
    - [ ] Write a `vignette` for the R package explaining how to run a simulation.
    - [ ] Draft Manuscript 1 (Methods Paper).
    - [ ] Draft Manuscript 2 (Policy Application Paper).

---
